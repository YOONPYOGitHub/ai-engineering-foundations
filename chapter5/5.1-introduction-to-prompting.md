# 5.1 Introduction to Prompting

## ğŸ“š ê°œìš”

í”„ë¡¬í”„íŠ¸ëŠ” ëª¨ë¸ì—ê²Œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ ì£¼ì–´ì§€ëŠ” ì§€ì‹œì…ë‹ˆë‹¤. ì´ ì„¹ì…˜ì—ì„œëŠ” í”„ë¡¬í”„íŠ¸ì˜ êµ¬ì¡°, In-Context Learningì˜ ì›ë¦¬, ê·¸ë¦¬ê³  System/User Promptì˜ ì—­í• ì„ í•™ìŠµí•©ë‹ˆë‹¤.

---

## ğŸ¯ í”„ë¡¬í”„íŠ¸ë€?

### ì •ì˜
> **Prompt**: ëª¨ë¸ì´ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ ì£¼ì–´ì§€ëŠ” ì§€ì‹œ (instruction)

### í”„ë¡¬í”„íŠ¸ì˜ êµ¬ì„±ìš”ì†Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PROMPT                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Task Description                                     â”‚
â”‚     - ëª¨ë¸ì´ í•´ì•¼ í•  ì¼                                   â”‚
â”‚     - ì—­í•  (persona)                                     â”‚
â”‚     - ì¶œë ¥ í˜•ì‹                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. Examples (Optional)                                  â”‚
â”‚     - ì‘ì—… ìˆ˜í–‰ ë°©ë²• ì˜ˆì‹œ                                 â”‚
â”‚     - Few-shot learning                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. Task                                                 â”‚
â”‚     - êµ¬ì²´ì ì¸ ì‘ì—… ë‚´ìš©                                  â”‚
â”‚     - ì§ˆë¬¸, ìš”ì•½í•  ë¬¸ì„œ, ë¶„ë¥˜í•  í…ìŠ¤íŠ¸ ë“±                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì˜ˆì‹œ: NER (Named Entity Recognition)

```
[Task Description]
Extract all named entities from the following text.
Output format: JSON with keys "person", "organization", "location".

[Examples]
Text: "Apple CEO Tim Cook announced the new iPhone in Cupertino."
Output: {"person": ["Tim Cook"], "organization": ["Apple"], "location": ["Cupertino"]}

[Task]
Text: "Elon Musk visited Tesla's factory in Berlin yesterday."
Output:
```

---

## ğŸ§  In-Context Learning

### ì •ì˜
> **In-Context Learning**: í”„ë¡¬í”„íŠ¸ ë‚´ì˜ ì˜ˆì‹œë¥¼ í†µí•´ ëª¨ë¸ì´ ì›í•˜ëŠ” í–‰ë™ì„ í•™ìŠµí•˜ëŠ” ê²ƒ

GPT-3 ë…¼ë¬¸ "Language Models Are Few-shot Learners" (Brown et al., 2020)ì—ì„œ ì†Œê°œë˜ì—ˆìŠµë‹ˆë‹¤.

### Zero-shot vs Few-shot

| ìœ í˜• | ì„¤ëª… | ì˜ˆì‹œ |
|------|------|------|
| **Zero-shot** | ì˜ˆì‹œ ì—†ì´ ì§€ì‹œë§Œ ì œê³µ | "ì´ í…ìŠ¤íŠ¸ë¥¼ ë²ˆì—­í•´ì¤˜" |
| **One-shot** | 1ê°œì˜ ì˜ˆì‹œ ì œê³µ | ì§€ì‹œ + 1ê°œ ì˜ˆì‹œ |
| **Few-shot** | 2ê°œ ì´ìƒì˜ ì˜ˆì‹œ ì œê³µ | ì§€ì‹œ + 3-5ê°œ ì˜ˆì‹œ |

### Few-shot ì˜ˆì‹œ

```
# Zero-shot
Label this item as edible or inedible: pizza

# Few-shot (3-shot)
chickpea --> edible
box --> inedible
apple --> edible
pizza -->
```

### ì˜ˆì‹œ ê°œìˆ˜ì˜ Trade-off

```
ë” ë§ì€ ì˜ˆì‹œ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ì¥ì            â”‚     â”‚ ë‹¨ì            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë” ì¢‹ì€ ì„±ëŠ¥    â”‚     â”‚ ë” ê¸´ í”„ë¡¬í”„íŠ¸  â”‚
â”‚ ë” ëª…í™•í•œ ì˜ë„  â”‚     â”‚ ë” ë†’ì€ ë¹„ìš©    â”‚
â”‚ ì—ì§€ ì¼€ì´ìŠ¤ ì»¤ë²„â”‚     â”‚ Context ì œí•œ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### In-Context Learningì´ ì‘ë™í•˜ëŠ” ì´ìœ 

FranÃ§ois Chollet (Keras ì°½ì‹œì)ì˜ ì„¤ëª…:
> Foundation Model = **í”„ë¡œê·¸ë¨ë“¤ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬**
> - í•˜ì´ì¿  ì‘ì„± í”„ë¡œê·¸ë¨
> - ë¦¬ë©”ë¦­ ì‘ì„± í”„ë¡œê·¸ë¨
> - ë²ˆì—­ í”„ë¡œê·¸ë¨
> - ...
> 
> **Prompt Engineering = ì›í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ í™œì„±í™”í•˜ëŠ” ì˜¬ë°”ë¥¸ í”„ë¡¬í”„íŠ¸ ì°¾ê¸°**

---

## ğŸ’¬ System Prompt vs User Prompt

### ì—­í•  êµ¬ë¶„

| êµ¬ë¶„ | ì—­í•  | ì‘ì„±ì |
|------|------|--------|
| **System Prompt** | ëª¨ë¸ì˜ í–‰ë™ ë°©ì‹ ì •ì˜ | ê°œë°œì |
| **User Prompt** | êµ¬ì²´ì ì¸ ì‘ì—… ìš”ì²­ | ì‚¬ìš©ì |

### ì˜ˆì‹œ: ë¶€ë™ì‚° ì±—ë´‡

```
[System Prompt]
You're an experienced real estate agent. Your job is to read each 
disclosure carefully, fairly assess the condition of the property 
based on this disclosure, and help your buyer understand the risks 
and opportunities of each property. For each question, answer 
succinctly and professionally.

[User Prompt]
Context: [disclosure.pdf]
Question: Summarize the noise complaints, if any, about this property.
Answer:
```

### Chat Template

ëª¨ë¸ë§ˆë‹¤ ë‹¤ë¥¸ í…œí”Œë¦¿ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

**Llama 2:**
```
<s>[INST] <<SYS>>
{{ system_prompt }}
<</SYS>>
{{ user_message }} [/INST]
```

**Llama 3:**
```
<|begin_of_text|><|start_header_id|>system<|end_header_id|>
{{ system_prompt }}<|eot_id|><|start_header_id|>user<|end_header_id|>
{{ user_message }}<|eot_id|><|start_header_id|>assistant<|end_header_id|>
```

### âš ï¸ Template ì£¼ì˜ì‚¬í•­

```python
# ì˜¬ë°”ë¥¸ í…œí”Œë¦¿ ì‚¬ìš© ì²´í¬ë¦¬ìŠ¤íŠ¸
checklist = [
    "ëª¨ë¸ì˜ ê³µì‹ chat template í™•ì¸",
    "ì„œë“œíŒŒí‹° ë„êµ¬ê°€ ì˜¬ë°”ë¥¸ í…œí”Œë¦¿ ì‚¬ìš©í•˜ëŠ”ì§€ ê²€ì¦",
    "ì¿¼ë¦¬ ì „ì†¡ ì „ ìµœì¢… í”„ë¡¬í”„íŠ¸ ì¶œë ¥í•˜ì—¬ í™•ì¸",
    "íŠ¹ìˆ˜ í† í° ëˆ„ë½/ì¶”ê°€ ì—¬ë¶€ í™•ì¸"
]
```

> **ì¼ë°˜ì ì¸ ë¬¸ì œ**: í…œí”Œë¦¿ ë¶ˆì¼ì¹˜ëŠ” silent failureë¥¼ ìœ ë°œí•©ë‹ˆë‹¤ - ëª¨ë¸ì´ ë­”ê°€ í•©ë¦¬ì ì¸ ê²ƒì„ ì¶œë ¥í•˜ì§€ë§Œ ìµœì ì€ ì•„ë‹™ë‹ˆë‹¤.

### System Promptê°€ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ì´ìœ 

1. **ìœ„ì¹˜ íš¨ê³¼**: System promptê°€ ë¨¼ì € ì™€ì„œ ëª¨ë¸ì´ ë” ì˜ ì²˜ë¦¬
2. **í›ˆë ¨ íš¨ê³¼**: ëª¨ë¸ì´ system promptì— ë” ì£¼ì˜ë¥¼ ê¸°ìš¸ì´ë„ë¡ post-trainingë¨

---

## ğŸ“ Context Lengthì™€ Context Efficiency

### Context Length ë°œì „

| ëª¨ë¸ | ì—°ë„ | Context Length | ë¹„ê³  |
|------|------|----------------|------|
| GPT-2 | 2019.02 | 1K | ëŒ€í•™ ì—ì„¸ì´ ìˆ˜ì¤€ |
| GPT-3 | 2020 | 4K | - |
| GPT-4 | 2023.03 | 128K | ì±… í•œ ê¶Œ |
| Claude 2 | 2023.07 | 100K | - |
| Gemini 1.5 Pro | 2024.02 | 2M | ì•½ 2,000ê°œ ìœ„í‚¤í”¼ë””ì•„ í˜ì´ì§€ |

> **5ë…„ê°„ 2,000ë°° ì¦ê°€!** (1K â†’ 2M)

### Needle in a Haystack (NIAH) í…ŒìŠ¤íŠ¸

ëª¨ë¸ì´ ê¸´ í”„ë¡¬í”„íŠ¸ì˜ ì–´ëŠ ìœ„ì¹˜ì—ì„œ ì •ë³´ë¥¼ ì–¼ë§ˆë‚˜ ì˜ ì°¾ëŠ”ì§€ í‰ê°€í•©ë‹ˆë‹¤.

```
ë°©ë²•:
1. ê¸´ í…ìŠ¤íŠ¸(haystack) ì¤€ë¹„
2. ëœë¤í•œ ì •ë³´(needle)ë¥¼ ë‹¤ì–‘í•œ ìœ„ì¹˜ì— ì‚½ì…
3. ëª¨ë¸ì—ê²Œ í•´ë‹¹ ì •ë³´ë¥¼ ì°¾ë„ë¡ ìš”ì²­
4. ìœ„ì¹˜ë³„ ì„±ëŠ¥ ì¸¡ì •
```

### ìœ„ì¹˜ë³„ ì„±ëŠ¥ ì°¨ì´

```
í”„ë¡¬í”„íŠ¸ ë‚´ ì •ë³´ ìœ„ì¹˜:

ì‹œì‘ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ ë†’ì€ ì„±ëŠ¥
ì¤‘ê°„ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ            ë‚®ì€ ì„±ëŠ¥ âš ï¸
ë   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    ë†’ì€ ì„±ëŠ¥

â†’ "Lost in the Middle" í˜„ìƒ
```

### ì‹¤ìš©ì  ì‹œì‚¬ì 

1. **ì¤‘ìš”í•œ ì •ë³´ëŠ” ì‹œì‘ì´ë‚˜ ëì— ë°°ì¹˜**
2. **ê¸´ í”„ë¡¬í”„íŠ¸ ì‚¬ìš© ì‹œ NIAH í…ŒìŠ¤íŠ¸ ì‹¤í–‰**
3. **ëª¨ë¸ì˜ context efficiency í™•ì¸ (RULER ë²¤ì¹˜ë§ˆí¬)**

---

## ğŸ“ ìš©ì–´ ì •ë¦¬

| ìš©ì–´ | ì„¤ëª… |
|------|------|
| **Prompt** | ëª¨ë¸ì— ì£¼ì–´ì§€ëŠ” ì „ì²´ ì…ë ¥ |
| **Context** | ì‘ì—… ìˆ˜í–‰ì— í•„ìš”í•œ ì •ë³´ (ë¬¸ì„œ, ë°ì´í„° ë“±) |
| **Shot** | í”„ë¡¬í”„íŠ¸ ë‚´ ì˜ˆì‹œ í•˜ë‚˜ |
| **Chat Template** | ëª¨ë¸ì´ ì‹œìŠ¤í…œ/ìœ ì € í”„ë¡¬í”„íŠ¸ë¥¼ ê²°í•©í•˜ëŠ” í˜•ì‹ |
| **In-Context Learning** | í”„ë¡¬í”„íŠ¸ ë‚´ ì˜ˆì‹œë¡œë¶€í„° í•™ìŠµ |
| **NIAH** | Needle in a Haystack, context íš¨ìœ¨ì„± í…ŒìŠ¤íŠ¸ |

---

## ğŸ’¡ í•µì‹¬ ìš”ì•½

1. **í”„ë¡¬í”„íŠ¸ êµ¬ì¡°**: Task Description + Examples + Task
2. **In-Context Learning**: ì˜ˆì‹œë¥¼ í†µí•œ í•™ìŠµ, weight ì—…ë°ì´íŠ¸ ë¶ˆí•„ìš”
3. **System vs User Prompt**: ê°œë°œì ì§€ì‹œ vs ì‚¬ìš©ì ìš”ì²­
4. **Chat Template ì¤‘ìš”**: ì˜ëª»ëœ í…œí”Œë¦¿ = Silent Failure
5. **Context Length**: ê¸‰ê²©íˆ ì¦ê°€ ì¤‘ì´ì§€ë§Œ ì¤‘ê°„ ìœ„ì¹˜ ì„±ëŠ¥ ì €í•˜ ì£¼ì˜

---

## â“ í† ë¡  ì§ˆë¬¸

1. Few-shot ì˜ˆì‹œë¥¼ ì„ íƒí•  ë•Œ ì–´ë–¤ ê¸°ì¤€ì„ ì‚¬ìš©í•´ì•¼ í• ê¹Œìš”?

2. System Promptì™€ User Promptë¥¼ ì–´ë–»ê²Œ ë¶„ë¦¬í•´ì•¼ ìµœì ì˜ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ê¹Œìš”?

3. Context Lengthê°€ ë¬´í•œëŒ€ê°€ ëœë‹¤ë©´ RAGëŠ” ë” ì´ìƒ í•„ìš” ì—†ì„ê¹Œìš”?
